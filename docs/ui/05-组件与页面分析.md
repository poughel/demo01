# DataSophon UI 模块 - 组件与页面分析

## 一、概述

DataSophon UI 包含 **56 个通用组件**和 **51 个页面组件**，采用组件化开发模式，实现了高度的代码复用和模块化设计。

### 组件分类

| 类别 | 数量 | 说明 |
|------|------|------|
| 通用组件 | 56 | 可复用的 UI 组件 |
| 页面组件 | 51 | 业务页面 |
| 布局组件 | 3 | TabsView, PageView, BlankView |
| 总计 | 110 | 所有 Vue 组件 |

## 二、通用组件系统

### 2.1 组件目录结构

```
src/components/
├── alarmModal/          # 告警弹窗
│   └── index.vue
├── card/                # 卡片组件
│   └── ChartCard.vue
├── chart/               # 图表组件 (8个)
│   ├── Bar.vue
│   ├── MiniArea.vue
│   ├── MiniBar.vue
│   ├── MiniProgress.vue
│   ├── Radar.vue
│   ├── RankingList.vue
│   └── Trend.vue
├── checkbox/            # 复选框 (2个)
│   ├── ColorCheckbox.vue
│   └── ImgCheckbox.vue
├── commonTemplate/      # 通用模板 (2个)
│   ├── index.vue
│   └── index2.vue
├── editor/              # 编辑器
│   └── index.vue
├── exception/           # 异常页面
│   └── ExceptionPage.vue
├── form/                # 表单组件
│   └── FormRow.vue
├── input/               # 输入组件
│   └── IInput.vue
├── logs/                # 日志组件
│   └── index.vue
├── menu/                # 菜单组件 (4个)
│   ├── Contextmenu.vue
│   ├── SideMenu.vue
│   ├── clusterMenu.vue
│   └── serviceOption.vue
├── overview/            # 总览组件
│   └── index.vue
├── page/                # 页面组件
│   └── header/
│       └── PageHeader.vue
├── result/              # 结果页
│   └── Result.vue
├── setting/             # 设置组件 (2个)
│   ├── Setting.vue
│   └── SettingItem.vue
├── steps/               # 步骤条 (10个)
│   ├── index.vue
│   ├── step1.vue ~ step8.vue
│   └── stpesRf.vue
├── table/               # 表格组件 (5个)
│   ├── StandardTable.vue
│   └── advance/
│       ├── AdvanceTable.vue
│       ├── ActionColumns.vue
│       ├── ActionSize.vue
│       └── SearchArea.vue
├── task/                # 任务组件 (2个)
│   ├── TaskGroup.vue
│   └── TaskItem.vue
├── tool/                # 工具组件 (8个)
│   ├── AStepItem.vue
│   ├── AvatarList.vue
│   ├── DetailList.vue
│   ├── Drawer.vue
│   ├── FooterToolBar.vue
│   ├── HeadInfo.vue
│   ├── TagSelect.vue
│   └── TagSelectOption.vue
└── transition/          # 过渡动画
    └── PageToggleTransition.vue
```

### 2.2 核心通用组件详解

#### 1. 图表组件 (chart/)

##### Bar.vue - 柱状图
```vue
<template>
  <v-chart :force-fit="true" :height="height" :data="data" :scale="scale">
    <v-tooltip />
    <v-axis />
    <v-bar position="x*y" :color="color" />
  </v-chart>
</template>

<script>
export default {
  name: 'Bar',
  props: {
    data: Array,      // 数据源
    height: Number,   // 高度
    color: String,    // 颜色
    scale: Object     // 坐标轴配置
  }
}
</script>
```

**使用场景**: 集群资源使用统计、服务实例数量对比

##### MiniArea.vue - 迷你面积图
```vue
<template>
  <div class="mini-area">
    <v-chart :force-fit="true" :height="height" :data="data" :padding="[0, 0, 0, 0]">
      <v-area position="x*y" :color="color" />
      <v-line position="x*y" :color="color" size="2" />
    </v-chart>
  </div>
</template>
```

**使用场景**: CPU、内存使用率趋势图

##### Trend.vue - 趋势指标
```vue
<template>
  <div class="trend">
    <span class="value">{{ value }}</span>
    <span :class="['trend-icon', flag]">
      <a-icon :type="flag === 'up' ? 'caret-up' : 'caret-down'" />
      <span>{{ percent }}%</span>
    </span>
  </div>
</template>
```

**使用场景**: 显示指标变化趋势

#### 2. 表格组件 (table/)

##### StandardTable.vue - 标准表格
```vue
<template>
  <div class="standard-table">
    <a-table
      :columns="columns"
      :data-source="dataSource"
      :pagination="pagination"
      :loading="loading"
      :row-selection="rowSelection"
      @change="handleTableChange"
    >
      <template v-for="slot in Object.keys($scopedSlots)" :slot="slot" slot-scope="text, record, index">
        <slot :name="slot" v-bind="{text, record, index}"></slot>
      </template>
    </a-table>
  </div>
</template>
```

**特性**:
- 分页
- 排序
- 筛选
- 行选择
- 自定义列渲染

**使用示例**:
```vue
<standard-table
  :columns="columns"
  :data-source="list"
  :loading="loading"
  :pagination="pagination"
  @change="handleChange"
>
  <template slot="action" slot-scope="{record}">
    <a @click="handleEdit(record)">编辑</a>
    <a-divider type="vertical" />
    <a @click="handleDelete(record)">删除</a>
  </template>
</standard-table>
```

#### 3. 步骤条组件 (steps/)

##### index.vue - 步骤条主组件
```vue
<template>
  <div class="steps-content">
    <a-steps :current="current">
      <a-step v-for="item in steps" :key="item.title" :title="item.title" />
    </a-steps>
    <div class="steps-content">
      <component :is="currentStep" @next="handleNext" @prev="handlePrev" />
    </div>
    <div class="steps-action">
      <a-button v-if="current > 0" @click="handlePrev">上一步</a-button>
      <a-button v-if="current < steps.length - 1" type="primary" @click="handleNext">
        下一步
      </a-button>
      <a-button v-if="current === steps.length - 1" type="primary" @click="handleFinish">
        完成
      </a-button>
    </div>
  </div>
</template>
```

**步骤组件列表**:
- `step1.vue` - 集群基础信息
- `step2.vue` - 选择主机
- `step3.vue` - 选择服务
- `step4.vue` - 配置服务
- `step5.vue` - 角色分配
- `step6.vue` - 配置确认
- `step7.vue` - 安装进度
- `step8.vue` - 安装完成

**使用场景**: 集群创建向导

#### 4. 菜单组件 (menu/)

##### SideMenu.vue - 侧边菜单
```vue
<template>
  <a-menu
    :mode="mode"
    :theme="theme"
    :open-keys="openKeys"
    :selected-keys="selectedKeys"
    @openChange="onOpenChange"
  >
    <template v-for="item in menuData">
      <a-menu-item v-if="!item.children" :key="item.path">
        <a-icon :type="item.meta.icon" />
        <span>{{ item.meta.title }}</span>
      </a-menu-item>
      <sub-menu v-else :key="item.path" :menu-info="item" />
    </template>
  </a-menu>
</template>
```

**特性**:
- 支持多级菜单
- 图标显示
- 权限控制
- 展开/折叠

##### clusterMenu.vue - 集群菜单
```vue
<template>
  <a-menu mode="inline" :selected-keys="selectedKeys">
    <a-menu-item key="overview">
      <router-link :to="{name: 'overview'}">
        <a-icon type="dashboard" />
        <span>总览</span>
      </router-link>
    </a-menu-item>
    <a-sub-menu key="services">
      <span slot="title">
        <a-icon type="appstore" />
        <span>服务管理</span>
      </span>
      <a-menu-item v-for="service in services" :key="service.id">
        <router-link :to="{name: 'serviceDetail', params: {id: service.id}}">
          {{ service.name }}
        </router-link>
      </a-menu-item>
    </a-sub-menu>
  </a-menu>
</template>
```

**特性**:
- 动态服务菜单
- 集群上下文
- 服务状态显示

#### 5. 编辑器组件 (editor/)

##### index.vue - Monaco Editor 封装
```vue
<template>
  <div ref="editorContainer" class="editor-container"></div>
</template>

<script>
import * as monaco from 'monaco-editor'

export default {
  name: 'Editor',
  props: {
    value: String,           // 编辑器内容
    language: String,        // 语言类型
    readOnly: Boolean,       // 只读模式
    theme: String            // 主题
  },
  mounted() {
    this.initEditor()
  },
  methods: {
    initEditor() {
      this.editor = monaco.editor.create(this.$refs.editorContainer, {
        value: this.value,
        language: this.language || 'xml',
        theme: this.theme || 'vs',
        readOnly: this.readOnly || false,
        automaticLayout: true
      })
      
      this.editor.onDidChangeModelContent(() => {
        this.$emit('input', this.editor.getValue())
      })
    }
  }
}
</script>
```

**支持语言**:
- XML (配置文件)
- Properties
- YAML
- JSON
- Shell

**使用场景**: 服务配置文件编辑

#### 6. 日志组件 (logs/)

##### index.vue - 日志查看器
```vue
<template>
  <div class="logs-viewer">
    <div class="logs-toolbar">
      <a-button @click="handleRefresh">刷新</a-button>
      <a-button @click="handleDownload">下载</a-button>
      <a-button @click="handleClear">清空</a-button>
    </div>
    <div class="logs-content" ref="logsContent">
      <pre>{{ logs }}</pre>
    </div>
  </div>
</template>

<script>
export default {
  name: 'Logs',
  data() {
    return {
      logs: '',
      autoScroll: true
    }
  },
  methods: {
    appendLog(line) {
      this.logs += line + '\n'
      if (this.autoScroll) {
        this.scrollToBottom()
      }
    },
    scrollToBottom() {
      this.$nextTick(() => {
        const el = this.$refs.logsContent
        el.scrollTop = el.scrollHeight
      })
    }
  }
}
</script>
```

**特性**:
- 实时日志流
- 自动滚动
- 日志下载
- 日志清空

## 三、页面组件系统

### 3.1 页面目录结构

```
src/pages/
├── alarmManage/         # 告警管理 (6个)
│   ├── commponents/
│   │   ├── addGroup.vue
│   │   ├── addMetric.vue
│   │   ├── authCluster.vue
│   │   └── delectColony.vue
│   ├── group.vue
│   └── metric.vue
├── colonyManage/        # 集群管理 (8个)
│   ├── clusterList/
│   │   └── index.vue
│   ├── commponents/
│   │   ├── addColony.vue
│   │   ├── authCluster.vue
│   │   └── delectColony.vue
│   ├── frame.vue
│   ├── list.vue
│   └── parcel.vue
├── exception/           # 异常页面 (3个)
│   ├── 403.vue
│   ├── 404.vue
│   └── 500.vue
├── hostManage/          # 主机管理 (5个)
│   ├── addLabel.vue
│   ├── addRack.vue
│   ├── distributionRack.vue
│   ├── index.vue
│   └── roleModal.vue
├── login/               # 登录 (1个)
│   └── Login.vue
├── overview/            # 总览 (1个)
│   └── index.vue
├── result/              # 结果页 (2个)
│   ├── Error.vue
│   └── Success.vue
├── securityCenter/      # 安全中心 (4个)
│   ├── commponents/
│   │   ├── addUser.vue
│   │   └── delectUser.vue
│   └── user.vue
├── serviceManage/       # 服务管理 (11个)
│   ├── addCharacter.vue
│   ├── addQueue.vue
│   ├── allotCharacter.vue
│   ├── convertQueue.vue
│   ├── deleteModal.vue
│   ├── exampleList.vue
│   ├── index.vue
│   ├── overViewPage.vue
│   ├── queue.vue
│   ├── queueGraph.vue
│   ├── renameGroup.vue
│   └── setting.vue
└── systemCenter/        # 系统中心 (10个)
    ├── commponents/
    │   ├── addUser.vue
    │   ├── addUserGroup.vue
    │   ├── delectUser.vue
    │   └── delectUserGroup.vue
    ├── frame/
    │   ├── commponents/
    │   │   ├── addFrame.vue
    │   │   └── deleteFrame.vue
    │   └── index.vue
    ├── tag/
    │   ├── commponents/
    │   │   ├── addTag.vue
    │   │   └── deleteTag.vue
    │   └── index.vue
    └── user.vue
```

### 3.2 核心页面详解

#### 1. 登录页面 (login/Login.vue)

```vue
<template>
  <div class="login-container">
    <div class="login-form">
      <h2>DataSophon 管理平台</h2>
      <a-form :form="form" @submit="handleSubmit">
        <a-form-item>
          <a-input
            v-decorator="['username', {rules: [{required: true, message: '请输入用户名'}]}]"
            placeholder="用户名"
          >
            <a-icon slot="prefix" type="user" />
          </a-input>
        </a-form-item>
        <a-form-item>
          <a-input-password
            v-decorator="['password', {rules: [{required: true, message: '请输入密码'}]}]"
            placeholder="密码"
          >
            <a-icon slot="prefix" type="lock" />
          </a-input-password>
        </a-form-item>
        <a-form-item>
          <a-button type="primary" html-type="submit" block :loading="loading">
            登录
          </a-button>
        </a-form-item>
      </a-form>
    </div>
  </div>
</template>
```

**功能**:
- 用户名/密码登录
- 表单验证
- 记住登录状态
- 错误提示

#### 2. 总览页面 (overview/index.vue)

```vue
<template>
  <div class="overview-page">
    <!-- 集群概览卡片 -->
    <a-row :gutter="16">
      <a-col :span="6" v-for="item in overview" :key="item.key">
        <chart-card
          :title="item.title"
          :total="item.total"
          :icon="item.icon"
          :color="item.color"
        >
          <mini-area :data="item.data" :color="item.color" />
        </chart-card>
      </a-col>
    </a-row>
    
    <!-- 服务状态 -->
    <a-card title="服务状态" :bordered="false">
      <a-table :columns="columns" :data-source="services" />
    </a-card>
    
    <!-- 资源使用 -->
    <a-row :gutter="16">
      <a-col :span="12">
        <a-card title="CPU 使用率">
          <bar :data="cpuData" />
        </a-card>
      </a-col>
      <a-col :span="12">
        <a-card title="内存使用率">
          <bar :data="memoryData" />
        </a-card>
      </a-col>
    </a-row>
  </div>
</template>
```

**展示内容**:
- 集群概览（节点数、服务数、告警数）
- 服务状态列表
- 资源使用趋势
- 告警信息

#### 3. 集群管理 (colonyManage/list.vue)

```vue
<template>
  <div class="colony-list">
    <!-- 工具栏 -->
    <div class="toolbar">
      <a-button type="primary" @click="handleAdd">
        <a-icon type="plus" />
        创建集群
      </a-button>
      <a-input-search
        placeholder="搜索集群"
        style="width: 300px"
        @search="handleSearch"
      />
    </div>
    
    <!-- 集群列表 -->
    <standard-table
      :columns="columns"
      :data-source="clusterList"
      :loading="loading"
      :pagination="pagination"
      @change="handleTableChange"
    >
      <template slot="status" slot-scope="{text}">
        <a-badge :status="getStatusBadge(text)" :text="text" />
      </template>
      <template slot="action" slot-scope="{record}">
        <a @click="handleView(record)">查看</a>
        <a-divider type="vertical" />
        <a @click="handleEdit(record)">编辑</a>
        <a-divider type="vertical" />
        <a-popconfirm title="确定删除?" @confirm="handleDelete(record)">
          <a>删除</a>
        </a-popconfirm>
      </template>
    </standard-table>
    
    <!-- 创建集群对话框 -->
    <add-colony
      :visible="addVisible"
      @ok="handleAddOk"
      @cancel="handleAddCancel"
    />
  </div>
</template>
```

**功能**:
- 集群列表展示
- 创建集群向导
- 编辑集群信息
- 删除集群
- 集群搜索

#### 4. 服务管理 (serviceManage/index.vue)

```vue
<template>
  <div class="service-manage">
    <!-- 服务列表 -->
    <a-list :data-source="services" :grid="{gutter: 16, column: 3}">
      <a-list-item slot="renderItem" slot-scope="item">
        <a-card :hoverable="true" @click="handleServiceClick(item)">
          <a-card-meta>
            <div slot="avatar">
              <a-avatar :src="item.icon" :size="48" />
            </div>
            <div slot="title">{{ item.name }}</div>
            <div slot="description">
              <a-badge :status="getStatusType(item.status)" :text="item.status" />
              <div>{{ item.instanceCount }} 个实例</div>
            </div>
          </a-card-meta>
        </a-card>
      </a-list-item>
    </a-list>
    
    <!-- 服务详情 -->
    <a-drawer
      :visible="drawerVisible"
      :width="720"
      @close="handleDrawerClose"
    >
      <div slot="title">
        {{ currentService.name }} - 服务详情
      </div>
      
      <!-- 操作按钮 -->
      <a-space>
        <a-button @click="handleStart">启动</a-button>
        <a-button @click="handleStop">停止</a-button>
        <a-button @click="handleRestart">重启</a-button>
        <a-button @click="handleConfig">配置</a-button>
      </a-space>
      
      <!-- 实例列表 -->
      <a-table
        :columns="instanceColumns"
        :data-source="instances"
        style="margin-top: 16px"
      />
    </a-drawer>
  </div>
</template>
```

**功能**:
- 服务列表展示
- 服务状态监控
- 服务启停控制
- 服务配置管理
- 实例列表查看

#### 5. 主机管理 (hostManage/index.vue)

```vue
<template>
  <div class="host-manage">
    <!-- 工具栏 -->
    <div class="toolbar">
      <a-button type="primary" @click="handleAdd">
        <a-icon type="plus" />
        添加主机
      </a-button>
      <a-button @click="handleBatchLabel">批量打标签</a-button>
      <a-button @click="handleBatchRack">批量分配机架</a-button>
    </div>
    
    <!-- 主机列表 -->
    <standard-table
      :columns="columns"
      :data-source="hostList"
      :loading="loading"
      :row-selection="rowSelection"
    >
      <template slot="status" slot-scope="{text}">
        <a-badge :status="getStatusBadge(text)" :text="text" />
      </template>
      <template slot="labels" slot-scope="{text}">
        <a-tag v-for="label in text" :key="label.id" :color="label.color">
          {{ label.name }}
        </a-tag>
      </template>
      <template slot="action" slot-scope="{record}">
        <a @click="handleLabel(record)">标签</a>
        <a-divider type="vertical" />
        <a @click="handleRack(record)">机架</a>
        <a-divider type="vertical" />
        <a @click="handleDelete(record)">删除</a>
      </template>
    </standard-table>
  </div>
</template>
```

**功能**:
- 主机列表管理
- 添加/删除主机
- 标签管理
- 机架分配
- 批量操作

#### 6. 告警管理 (alarmManage/group.vue)

```vue
<template>
  <div class="alarm-group">
    <!-- 告警组列表 -->
    <standard-table
      :columns="columns"
      :data-source="groups"
    >
      <template slot="notifyType" slot-scope="{text}">
        <a-tag v-for="type in text" :key="type">
          {{ type }}
        </a-tag>
      </template>
      <template slot="action" slot-scope="{record}">
        <a @click="handleEdit(record)">编辑</a>
        <a-divider type="vertical" />
        <a @click="handleDelete(record)">删除</a>
      </template>
    </standard-table>
  </div>
</template>
```

**功能**:
- 告警组管理
- 通知方式配置（邮件、短信、钉钉、企微）
- 告警规则配置

### 3.3 页面组件统计

| 业务模块 | 页面数 | 核心功能 |
|---------|-------|---------|
| 登录 | 1 | 用户认证 |
| 总览 | 1 | 集群状态概览 |
| 集群管理 | 8 | 集群CRUD、框架管理、Parcel |
| 服务管理 | 11 | 服务部署、配置、启停、监控 |
| 主机管理 | 5 | 主机管理、标签、机架 |
| 告警管理 | 6 | 告警组、告警指标、通知 |
| 安全中心 | 4 | 用户权限管理 |
| 系统中心 | 10 | 系统配置、租户、框架、标签 |
| 异常页面 | 3 | 403、404、500 |
| 结果页面 | 2 | 成功、失败 |
| **总计** | **51** | **所有业务功能** |

## 四、组件设计模式

### 4.1 容器组件 vs 展示组件

#### 容器组件 (Smart Components)
```vue
<!-- pages/colonyManage/list.vue -->
<script>
export default {
  data() {
    return {
      clusterList: [],
      loading: false
    }
  },
  mounted() {
    this.loadData()
  },
  methods: {
    async loadData() {
      this.loading = true
      try {
        this.clusterList = await this.$axiosGet(api.getClusterList)
      } finally {
        this.loading = false
      }
    }
  }
}
</script>
```

**特点**:
- 负责数据获取
- 管理状态
- 处理业务逻辑

#### 展示组件 (Dumb Components)
```vue
<!-- components/card/ChartCard.vue -->
<template>
  <a-card :bordered="false">
    <div slot="title">{{ title }}</div>
    <h2>{{ total }}</h2>
    <slot></slot>
  </a-card>
</template>

<script>
export default {
  props: {
    title: String,
    total: [String, Number]
  }
}
</script>
```

**特点**:
- 只负责展示
- 通过 props 接收数据
- 通过 events 通信

### 4.2 Mixins 复用

```javascript
// mixins/table.js
export default {
  data() {
    return {
      loading: false,
      dataSource: [],
      pagination: {
        current: 1,
        pageSize: 10,
        total: 0
      }
    }
  },
  methods: {
    handleTableChange(pagination, filters, sorter) {
      this.pagination = pagination
      this.loadData()
    }
  }
}
```

**使用**:
```vue
<script>
import tableMixin from '@/mixins/table'

export default {
  mixins: [tableMixin],
  methods: {
    async loadData() {
      this.loading = true
      try {
        const {list, total} = await this.$axiosGet(api.getList, {
          page: this.pagination.current,
          size: this.pagination.pageSize
        })
        this.dataSource = list
        this.pagination.total = total
      } finally {
        this.loading = false
      }
    }
  }
}
</script>
```

### 4.3 Slots 灵活性

```vue
<!-- components/table/StandardTable.vue -->
<template>
  <a-table v-bind="$attrs" v-on="$listeners">
    <!-- 默认插槽 -->
    <slot></slot>
    
    <!-- 具名插槽 -->
    <template v-for="slot in Object.keys($scopedSlots)" 
              :slot="slot" 
              slot-scope="scope">
      <slot :name="slot" v-bind="scope"></slot>
    </template>
  </a-table>
</template>
```

**使用**:
```vue
<standard-table :columns="columns" :data-source="data">
  <template slot="status" slot-scope="{text}">
    <a-badge :status="getStatus(text)" />
  </template>
  <template slot="action" slot-scope="{record}">
    <a @click="handleEdit(record)">编辑</a>
  </template>
</standard-table>
```

## 五、组件通信

### 5.1 Props / Events

```vue
<!-- 父组件 -->
<template>
  <child-component
    :value="value"
    @input="handleInput"
    @submit="handleSubmit"
  />
</template>

<script>
export default {
  methods: {
    handleInput(val) {
      this.value = val
    },
    handleSubmit(data) {
      console.log('提交:', data)
    }
  }
}
</script>
```

```vue
<!-- 子组件 -->
<template>
  <div>
    <input :value="value" @input="handleInput" />
    <button @click="handleSubmit">提交</button>
  </div>
</template>

<script>
export default {
  props: {
    value: String
  },
  methods: {
    handleInput(e) {
      this.$emit('input', e.target.value)
    },
    handleSubmit() {
      this.$emit('submit', this.value)
    }
  }
}
</script>
```

### 5.2 Provide / Inject

```vue
<!-- 祖先组件 -->
<script>
export default {
  provide() {
    return {
      clusterId: this.clusterId,
      clusterInfo: this.clusterInfo
    }
  }
}
</script>
```

```vue
<!-- 后代组件 -->
<script>
export default {
  inject: ['clusterId', 'clusterInfo'],
  mounted() {
    console.log('集群ID:', this.clusterId)
  }
}
</script>
```

### 5.3 EventBus

```javascript
// utils/eventBus.js
import Vue from 'vue'
export default new Vue()
```

```vue
<!-- 组件 A -->
<script>
import eventBus from '@/utils/eventBus'

export default {
  methods: {
    sendMessage() {
      eventBus.$emit('message', 'Hello from A')
    }
  }
}
</script>
```

```vue
<!-- 组件 B -->
<script>
import eventBus from '@/utils/eventBus'

export default {
  mounted() {
    eventBus.$on('message', (msg) => {
      console.log('收到消息:', msg)
    })
  },
  beforeDestroy() {
    eventBus.$off('message')
  }
}
</script>
```

### 5.4 Vuex

```javascript
// store/modules/cluster.js
export default {
  namespaced: true,
  state: {
    currentCluster: null
  },
  mutations: {
    setCurrentCluster(state, cluster) {
      state.currentCluster = cluster
    }
  },
  actions: {
    async selectCluster({commit}, clusterId) {
      const cluster = await api.getCluster(clusterId)
      commit('setCurrentCluster', cluster)
    }
  }
}
```

```vue
<!-- 使用 -->
<script>
import {mapState, mapActions} from 'vuex'

export default {
  computed: {
    ...mapState('cluster', ['currentCluster'])
  },
  methods: {
    ...mapActions('cluster', ['selectCluster'])
  }
}
</script>
```

## 六、性能优化

### 6.1 组件懒加载

```javascript
// 路由懒加载
{
  path: '/overview',
  component: () => import('@/pages/overview/index')
}

// 组件懒加载
components: {
  ChartCard: () => import('@/components/card/ChartCard')
}
```

### 6.2 v-if vs v-show

```vue
<!-- 频繁切换使用 v-show -->
<div v-show="visible">内容</div>

<!-- 条件很少改变使用 v-if -->
<div v-if="isAdmin">管理员内容</div>
```

### 6.3 列表优化

```vue
<!-- 使用 key -->
<div v-for="item in list" :key="item.id">
  {{ item.name }}
</div>

<!-- 虚拟滚动 (大列表) -->
<virtual-list
  :data-source="list"
  :item-height="50"
>
  <template slot-scope="{item}">
    <div>{{ item.name }}</div>
  </template>
</virtual-list>
```

### 6.4 计算属性缓存

```vue
<script>
export default {
  computed: {
    // 使用计算属性，结果会被缓存
    filteredList() {
      return this.list.filter(item => item.status === 'active')
    }
  }
}
</script>
```

## 七、最佳实践

### 7.1 组件命名

```javascript
// ✅ 推荐
components/
  ChartCard.vue       // PascalCase
  MiniArea.vue
  StandardTable.vue

// ❌ 避免
components/
  chartCard.vue       // camelCase
  miniarea.vue        // 全小写
  standard-table.vue  // kebab-case
```

### 7.2 Props 验证

```vue
<script>
export default {
  props: {
    // 基础验证
    title: String,
    
    // 多类型
    value: [String, Number],
    
    // 必填
    id: {
      type: Number,
      required: true
    },
    
    // 默认值
    status: {
      type: String,
      default: 'pending'
    },
    
    // 自定义验证
    age: {
      type: Number,
      validator(value) {
        return value >= 0 && value <= 150
      }
    }
  }
}
</script>
```

### 7.3 事件命名

```vue
<script>
export default {
  methods: {
    handleClick() {
      // ✅ kebab-case
      this.$emit('item-click', this.item)
      
      // ❌ camelCase
      // this.$emit('itemClick', this.item)
    }
  }
}
</script>
```

### 7.4 样式作用域

```vue
<style scoped>
/* scoped 样式只影响当前组件 */
.card {
  border: 1px solid #ddd;
}
</style>

<style>
/* 全局样式 */
body {
  margin: 0;
  padding: 0;
}
</style>
```

## 八、总结

### 组件统计

| 类别 | 数量 | 说明 |
|------|------|------|
| 图表组件 | 8 | Bar, Area, Progress, Trend 等 |
| 表格组件 | 5 | 标准表格、高级表格 |
| 表单组件 | 5 | Input, Checkbox, Editor 等 |
| 菜单组件 | 4 | 侧边菜单、集群菜单、服务选项 |
| 步骤条 | 10 | 8步集群创建向导 |
| 工具组件 | 8 | DetailList, Drawer, FooterToolBar 等 |
| 其他组件 | 16 | 卡片、日志、告警、任务等 |
| **通用组件** | **56** | **可复用组件** |
| **页面组件** | **51** | **业务页面** |
| **总计** | **107** | **所有 Vue 组件** |

### 设计特点

1. **组件化**: 高度模块化，复用性强
2. **层次清晰**: 容器组件 + 展示组件
3. **通信灵活**: Props/Events, Provide/Inject, EventBus, Vuex
4. **性能优化**: 懒加载、虚拟滚动、计算属性缓存
5. **开发友好**: 完善的 Props 验证、清晰的事件命名

---

**文档状态**: ✅ 已完成  
**组件数量**: 107 个 Vue 组件  
**最后更新**: 2025-11-16
